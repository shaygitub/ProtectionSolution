#pragma once
#include "definitions.h"
#define MOVJMPREG_ADDROFFS 2
#define MOVJMP_ADDROFFS 2
#define PUSHMOVXCHGRETREG_ADDROFFS 3
#define PUSHMOVXCHGRET_ADDROFFS 4

BYTE NtQueryFileHard[] = "\x40\x53\x48\x83\xec\x50\xf6\x9c\x24\xa0\x00\x00\x00\x48\x8b\xda\x1a\xc0\x24\x02\x44\x0f\xb6\xd8\x41\x8a\xc3";
BYTE NtQueryFileExHard[] = "\x8A\x84\x24\x80\x00\x00\x00\x41\xB1\x01\x4C\x8B\x84\x24\x88\x00\x00\x00\x48\x8B\x94\x24\x90\x00\x00\x00\x48\x8B\x8C\x24\x98\x00\x00\x00";
BYTE NtQuerySysInfoHard[] = "\x48\x83\xEC\x38\x45\x8B\xD0\x4C\x8B\xDA\x83\xF9\x4A\x7C\x21\x83\xF9\x53\x7D\x1C\x33\xD2\x44\x8B\xC2\x4C\x89\x4C\x24\x28";
BYTE NtCreateFileHard[] = "\x48\x81\xEC\x88\x00\x00\x00\x33\xC0\x48\x89\x44\x24\x78\xC7\x44\x24\x70\x20\x00\x00\x00\x89\x44\x24\x68\x48\x89\x44\x24\x60\x89\x44\x24\x58";
BYTE MmGetSysRoutineHard[] = "\x40\x53\x48\x83\xec\x30\x48\x8b\xd9\x48\x8b\xd1\x41\xb0\x01\x48\x8d\x4c\x24\x20";
BYTE RtlExpRtnByNameHard[] = "\x48\x89\x5c\x24\x08\x48\x89\x6c\x24\x10\x56\x57\x41\x54\x41\x56\x41\x57\x48\x83\xec\x20\x4c\x8b\xfa\x4c\x8d\x4c\x24\x60\xb2\x01\x45\x33\xc0\x48\x8b\xd9\x48\x8b\xd1\x41\xb0\x01\x48\x8d\x4c\x24\x20";
SYSCALL_PROTECT NtQueryDirFileProt;
SYSCALL_PROTECT NtQueryDirFileExProt;
SYSCALL_PROTECT NtCreateFileProt;
SYSCALL_PROTECT NtQuerySysInfoProt;


// Known mov+jmp hooking patterns:
const BYTE MovRaxJmpRax[] = "\x48\xB8\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xE0";
const char* MovRaxJmpRaxMask = "xx????????xx";

const BYTE MovRbxJmpRbx[] = "\x48\xBB\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xE3";
const char* MovRbxJmpRbxMask = "xx????????xx";

const BYTE MovRdiJmpRdi[] = "\x48\xBF\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xE7";
const char* MovRdiJmpRdiMask = "xx????????xx";

const BYTE MovRsiJmpRsi[] = "\x48\xBE\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xE6";
const char* MovRsiJmpRsiMask = "xx????????xx";

const BYTE MovR12JmpR12[] = "\x49\xBC\x00\x00\x00\x00\x00\x00\x00\x00\x41\xFF\xE4";
const char* MovR12JmpR12Mask = "xx????????xxx";

const BYTE MovR13JmpR13[] = "\x49\xBD\x00\x00\x00\x00\x00\x00\x00\x00\x41\xFF\xE5";
const char* MovR13JmpR13Mask = "xx????????xxx";

const BYTE MovR14JmpR14[] = "\x49\xBE\x00\x00\x00\x00\x00\x00\x00\x00\x41\xFF\xE6";
const char* MovR14JmpR14Mask = "xx????????xxx";

const BYTE MovR15JmpR15[] = "\x49\xBF\x00\x00\x00\x00\x00\x00\x00\x00\x41\xFF\xE7";
const char* MovR15JmpR15Mask = "xx????????xxx";


// Known push+mov+xchg+ret hooking patterns:
const BYTE PushMovXchgRetRax[] = "\x50\x48\xB8\x00\x00\x00\x00\x00\x00\x00\x00\x48\x87\x04\x24\xC3";
const char* PushMovXchgRetRaxMask = "xxx????????xxxxx";

const BYTE PushMovXchgRetRbx[] = "\x53\x48\xBB\x00\x00\x00\x00\x00\x00\x00\x00\x48\x87\x1C\x24\xC3";
const char* PushMovXchgRetRbxMask = "xxx????????xxxxx";

const BYTE PushMovXchgRetRdi[] = "\x57\x48\xBF\x00\x00\x00\x00\x00\x00\x00\x00\x48\x87\x3C\x24\xC3";
const char* PushMovXchgRetRdiMask = "xxx????????xxxxx";

const BYTE PushMovXchgRetRsi[] = "\x56\x48\xBE\x00\x00\x00\x00\x00\x00\x00\x00\x48\x87\x34\x24\xC3";
const char* PushMovXchgRetRsiMask = "xxx????????xxxxx";

const BYTE PushMovXchgRetR12[] = "\x41\x54\x49\xBC\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x87\x24\x24\xC3";
const char* PushMovXchgRetR12Mask = "xxxx????????xxxxx";

const BYTE PushMovXchgRetR13[] = "\x41\x55\x49\xBD\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x87\x2C\x24\xC3";
const char* PushMovXchgRetR13Mask = "xxxx????????xxxxx";

const BYTE PushMovXchgRetR14[] = "\x41\x56\x49\xBE\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x87\x34\x24\xC3";
const char* PushMovXchgRetR14Mask = "xxxx????????xxxxx";

const BYTE PushMovXchgRetR15[] = "\x41\x57\x49\xBF\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x87\x3C\x24\xC3";
const char* PushMovXchgRetR15Mask = "xxxx????????xxxxx";